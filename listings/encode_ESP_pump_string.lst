' функция кодирования параметров работы УЭЦН в строку
Public Function encode_ESP_pump_string( _
            Optional ByVal ESP_ID As Long = "1005", _
            Optional ByVal head_nom_m As Double = 2000, _
            Optional ByVal num_stages As Integer = 0, _
            Optional ByVal freq_Hz As Double = 50, _
            Optional ByVal gas_correct, _
            Optional ByVal calibr, _
            Optional ByVal dnum_stages_integrate = 1)
' esp_ID         - идентификатор насоса
' head_nom_m     - номинальный напор системы УЭЦН
'                - соответствует напора в записи ЭЦН 50-2000
' num_stages     - количество ступеней, если задано
'                  перекрывает значение напора
' freq_Hz        - частота, Гц
' t_intake_C     - температура на приеме насоа
' t_dis_C        - температура на выкиде насоса.
'                  если = 0 и calc_along_flow = 1 то рассчитывается
' gas_correct    - деградация по газу:
'      0 - 2 задает значение вручную;
'      10 стандартный ЭЦН (предел 25%);
'      20 ЭЦН с газостабилизирующим модулем (предел 50%);
'      30 ЭЦН с осевым модулем (предел 75%);
'      40 ЭЦН с модифицированным ступенями (предел 40%).
'      110+, тогда модель n-100 применяется ко всем ступеням отдельно
'         Предел по доле газа на входе в насос после сепарации
'         на основе статьи SPE 117414 (с корректировкой)
'         поправка дополнительная к деградации (суммируется).
' calibr    - коэффициент поправки на напор.
'     если массив то второе значение - поправыка на подачу (множитель)
'     третье на мощность (множитель)
' dnum_stages_integrate - шаг интегрирования для расчета
' результат         - строка с параметрами УЭЦН
