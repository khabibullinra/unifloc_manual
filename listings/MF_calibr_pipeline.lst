'  подбор параметров потока через трубу при известном
'  перепаде давления с использованием многофазных корреляций
Public Function MF_calibr_pipeline( _
                 ByVal p_calc_from_atma As Double, _
                 ByVal p_calc_to_atma As Double, _
             ByVal t_calc_from_C As Double, _
             ByVal t_val, _
             ByVal h_list_m As Variant, _
             ByVal diam_list_mm As Variant, _
             ByVal q_liq_sm3day As Double, _
             ByVal fw_perc As Double, _
    Optional ByVal q_gas_sm3day As Double = 0, _
    Optional ByVal str_PVT As String = PVT_DEFAULT, _
    Optional ByVal calc_flow_direction As Integer = 11, _
    Optional ByVal hydr_corr As H_CORRELATION = 0, _
    Optional ByVal temp_method As TEMP_CALC_METHOD = StartEndTemp, _
    Optional ByVal c_calibr = 1, _
    Optional ByVal roughness_m As Double = 0.0001, _
    Optional ByVal out_curves As Integer = 1, _
    Optional ByVal out_curves_num_points As Integer = 20, _
    Optional ByVal calibr_type As Integer = 0)
'p_calc_from_atma - давление начальное, атм
'                   граничное значение для проведения расчета
'p_calc_to_atma   - давление конечное, атм
'                   граничное значение для проведения расчета
' t_calc_from_C - температура в точке где задано давление расчета
' t_val     - температура вдоль трубопровода
'           если число то температура на другом конце трубы
'           если range или таблица [0..N,0..1] то температура
'           окружающей среды по вертикальной глубине, С
' h_list_m  - траектория трубопровода, если число то измеренная
'           длина, range или таблица [0..N,0..1] то траектория
' diam_list_mm  - внутрнний диаметр трубы, если число то задается
'           постоянный диаметр, если range или таблица [0..N,0..1]
'           то задается зависимость диаметра от измеренной длины
' q_liq_sm3day - дебит жидкости в поверхностных условиях, нм3/сут
'           если q_liq_sm3day =0 и q_gas_sm3day > 0
'           тогда считается барботаж газа через жидкость
' fw_perc   - обводненность объемная в стандартных условиях
' q_gas_sm3day  - свободный газ нм3/сут. дополнительный к PVT потоку.
'           учитывается для барботажа или режима потока газа
'           в других случаях добавляется к общему потоку меняя rp
' str_PVT   - закодированная строка с параметрами PVT.
'           если задана - перекрывает другие значения
'           если задан флаг gas_only = 1 то жидкость не учитывается
' calc_flow_direction - направление расчета и потока относительно
'           координат.  11 расчет и поток по координате
'                       10 расчет по коордиате, поток против
'                       00 расчет и поток против координате
'                       01 расчет против координат, поток по
' hydr_corr   - гидравлическая корреляция, H_CORRELATION
'           BeggsBrill = 0,
'           Ansari = 1,
'           Unified = 2,
'           Gray = 3,
'           HagedornBrown = 4,
'           SakharovMokhov = 5
' temp_method  - метод расчета температуры
'           0 - линейное распределение по длине
'           1 - температура равна температуре окружающей среды
'           2 - расчет температуры с учетом эмиссии в окр. среду
' c_calibr  - поправка на гравитационную составляющую
'           перепада давления, если дать ссылку на две ячейки,
'           то вторая будет поправка на трение.
' roughness_m - шероховатость трубы
' out_curves - флаг вывод значений между концами трубы
'           1 основные, 2 все значения.
'           вывод может замедлять расчет (не сильно)
' out_curves_num_points - количество точек для вывода значений
'           между концами трубы.
' calibr_type - тип калибровки
'          0 - подбор параметра c_calibr_grav
'          1 - подбор параметра c_calibr_fric
'          2 - подбор газового фактор
'          3 - подбор обводненности
' результат   - массив с подобранным парамером и подробностями.
