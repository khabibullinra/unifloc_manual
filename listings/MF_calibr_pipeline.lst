'  подбор параметров потока через трубу при известном
'  перепаде давления с использованием многофазных корреляций
Public Function MF_calibr_pipeline( _
                 ByVal qliq_sm3day As Double, _
                 ByVal fw_perc As Double, _
                 ByVal h_list_m As Variant, _
                 ByVal p_calc_from_atma As Double, _
                 ByVal p_calc_to_atma As Double, _
        Optional ByVal t_calc_from_C As Double = 50, _
        Optional ByVal calc_along_coord As Boolean = False, _
        Optional ByVal flow_along_coord As Boolean = False, _
        Optional ByVal str_PVT As String = PVT_DEFAULT, _
        Optional ByVal diam_list_mm As Variant, _
        Optional ByVal hydr_corr As H_CORRELATION = 0, _
        Optional ByVal t_amb_list_C As Variant, _
        Optional ByVal temp_method As TEMP_CALC_METHOD = StartEndTemp, _
        Optional ByVal c_calibr_grav = 1, _
        Optional ByVal c_calibr_fric = 1, _
        Optional ByVal roughness_m As Double = 0.0001, _
        Optional ByVal q_gas_sm3day As Double = 0, _
        Optional ByVal out_curves_num_points As Integer = 20, _
        Optional ByVal calibr_type As Integer = 0)
' qliq_sm3day - дебит жидкости в поверхностных условиях
'               если qliq_sm3day =0 и q_gas_sm3day > 0
'               тогда считается барботаж газа через жидкость
' fw_perc     - обводненность
' h_list_m    - траектория трубы.
'               число, range или таблица [0..N,0..1]
'p_calc_from_atma - давление начальное, атм
'                   граничное значение для проведения расчета
'p_calc_to_atma   - давление конечное, атм
'                   граничное значение для проведения расчета
' t_calc_from_C - температура в точке где задано давление расчета
' calc_along_coord - направление расчета относительно координаты
'                    если = 1 то расчет вдоль оси координат
'                    если = 0 то расчет против оси координат
' flow_along_coord - флаг направления потока относительно
'                    направления роста координаты
'                    если = 1 то поток вдоль оси координат
'                    если = 0 то поток против оси координат
' str_PVT     - закодированная строка с параметрами PVT.
'               если задана - перекрывает другие значения
'        если задан флаг gas_only = 1 то жидкость не учитывается
' diam_list_mm  - внутрнний диаметр трубы
'               число, range или таблица [0..N,0..1]
' hydr_corr   - гидравлическая корреляция, H_CORRELATION
'                  BeggsBrill = 0
'                  Ansari = 1
'                  Unified = 2
'                  Gray = 3
'                  HagedornBrown = 4
'                  SakharovMokhov = 5
' t_amb_list_C - температура окружающей среды, С
'                range или таблица [0..N,0..1]
' temp_method  - метод расчета температуры
'            0 - линейное распределение по длине
'            1 - температура равна температуре окружающей среды
'            2 - расчет температуры с учетом эмиссии в окр. среду
' c_calibr_grav - поправка на гравитационную составляющую
'               перепада давления
' c_calibr_fric - поправка на трение в перепаде давления
' roughness_m  - шероховатость трубы
' q_gas_sm3day  - свободный газ. дополнительный к PVT потоку.
' out_curves_num_points - количество точек для вывода значений
'                   между концами трубы.
' calibr_type - тип калибровки
'             0 - подбор параметра c_calibr_grav
'             1 - подбор параметра c_calibr_fric
'             2 - подбор газового фактор
'             3 - подбор обводненности
' результат   - массив с подобранным парамером и подробностями.
