'' Расчет забойного давления скважины,
'' расчет распределения давления и температуры в скважине
'' с использованием многофазных корреляций
'Public Function well_pwf_plin_atma( _
'             ByVal p_lin_atma As Double, _
'             ByVal t_wf_C As Double, _
'             ByVal t_val_C As Variant, _
'             ByVal h_list_m As Variant, _
'             ByVal d_tub_list_mm As Variant, _
'             ByVal d_cas_list_mm As Variant, _
'             ByVal q_liq_sm3day As Double, _
'             ByVal fw_perc As Double, _
'    Optional ByVal q_gas_sm3day As Double = 0, _
'    Optional ByVal str_PVT As String = PVT_DEFAULT, _
'    Optional ByVal str_AL As String = "", _
'    Optional ByVal p_cas_atma As Double, _
'    Optional ByVal d_choke_mm As Double, _
'    Optional ByVal hydr_corr As H_CORRELATION = 0, _
'    Optional ByVal temp_method As TEMP_CALC_METHOD = StartEndTemp, _
'    Optional ByVal c_calibr = 1, _
'    Optional ByVal roughness_m As Double = 0.0001, _
'    Optional ByVal out_curves As Integer = 1, _
'    Optional ByVal out_curves_num_points As Integer = 20, _
'    Optional ByVal num_value As Integer = 0)
'' Обязательные параметры
'' p_lin_atma - устьевое давление с которого начинается расчет, атм
''               граничное значение для проведения расчета
'' t_wf_C     - температура флюида на забое
'' t_val_C   - температура вдоль скважины
''           если число то температура на устье скважины
''           если range или таблица [0..N,0..1] то температура
''           окружающей среды по вертикальной глубине, С
'' h_list_m  - траектория скважины, если число то измеренная
''           длина, range или таблица [0..N,0..1] то траектория
'' d_tub_list_mm - диаметр НКТ. range или таблица [0..N,0..1]
'' d_cas_list_mm - диаметр эксп колонны. range или таблица [0..N,0..1]
'' qliq_sm3day - дебит жидкости в поверхностных условиях
'' fw_perc     - обводненность
'' q_gas_sm3day  - свободный газ поступающие в скважину
''               на забое для ЭЦН, в затруб для газлифта.
'' str_PVT     - закодированная строка с параметрами PVT.
''               если задана - перекрывает другие значения
'' str_AL      - закодированная параметров мех добычи.
''               строка параметров ЭЦН либо строка параметров газлифта
'' p_cas_atma  - затрубное давление (расчета Ндин)
'' d_choke_mm  - диаметр штуцера
'' hydr_corr    - гидравлическая корреляция, H_CORRELATION
''                  BeggsBrill = 0
''                  Ansari = 1
''                  Unified = 2
''                  Gray = 3
''                  HagedornBrown = 4
''                  SakharovMokhov = 5
'' temp_method  - температурная модель
'' c_calibr  - поправка на гравитационную составляющую
''           перепада давления, если дать ссылку на две ячейки,
''           то вторая будет поправка на трение.
'' roughness_m - шероховатость трубы
'' out_curves - флаг вывод значений между концами трубы
''           1 основные, 2 все значения.
''           вывод может замедлять расчет (не сильно)
'' out_curves_num_points - количество точек для вывода значений
''           между концами трубы.
'' num_value  - значение которое будет выводиться первым
'' результат - число - давление на устье скважины.
''           и распределение параметров по скважине.
