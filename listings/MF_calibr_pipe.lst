'  подбор параметров потока через трубу при известном
'  перепаде давления с использованием многофазных корреляций
' (лучше не использовать - используйте MF_calibr_pipeline)
Public Function MF_calibr_pipe( _
        ByVal p_calc_from_atma As Double, _
        ByVal p_calc_to_atma As Double, _
        ByVal t_calc_from_C As Double, _
        ByVal t_calc_to_C As Double, _
        ByVal length_m As Double, _
        ByVal theta_deg As Double, _
        ByVal d_mm As Double, _
        ByVal q_liq_sm3day As Double, _
        ByVal fw_perc As Double, _
        Optional ByVal q_gas_sm3day As Double = 0, _
        Optional ByVal str_PVT As String = PVT_DEFAULT, _
        Optional ByVal calc_flow_direction As Integer = 11, _
        Optional ByVal hydr_corr As H_CORRELATION = 0, _
        Optional ByVal c_calibr = 1, _
        Optional ByVal roughness_m As Double = 0.0001, _
        Optional ByVal calibr_type As Integer = 0)
'p_calc_from_atma - давление с которого начинается расчет, атм
'                   граничное значение для проведения расчета
' t_calc_from_C   - температура в точке где задано давление, С
' t_calc_to_C     - температура на другом конце трубы
'                 по умолчанию температура вдоль трубы постоянна
'                   если задано то меняется линейно по трубе
' length_m        - Длина трубы, измеренная, м
' theta_deg       - угол направления потока к горизонтали
' d_mm            - внутренний диаметр трубы
' q_liq_sm3day     - дебит жидкости в поверхностных условиях
'              если q_liq_sm3day =0 и q_gas_sm3day > 0
'              тогда считается барботаж газа через жидкость
' fw_perc         - обводненность
' q_gas_sm3day    - свободный газ. дополнительный к PVT потоку.
' str_PVT         - закодированная строка с параметрами PVT.
'                   если задана - перекрывает другие значения
'        если задан флаг gas_only = 1 то жидкость не учитывается
' calc_flow_direction - направление расчета и потока
'                   относительно координат
'                   если = 11 расчет и поток по координате
'                   если = 10 расчет по, поток против координат
'                   если = 00 расчет и поток против координате
'                   если = 01 расчет против, поток по координате
' hydr_corr       - гидравлическая корреляция, H_CORRELATION
'                    BeggsBrill = 0
'                    Ansari = 1
'                    Unified = 2
'                    Gray = 3
'                    HagedornBrown = 4
'                    SakharovMokhov = 5
' c_calibr        - поправка на гравитационную составляющую
'           перепада давления, если дать ссылку на две ячейки,
'           то вторая будет поправка на трение
' roughness_m     - шероховатость трубы
' out_curves      - флаг вывод значений между концами трубы
'                   0 минимум, 1 основные, 2 все значения.
'                   вывод может замедлять расчет (не сильно)
' out_curves_num_points - количество точек для вывода значений
'                   между концами трубы.
' результат       - число - давление на другом конце трубы atma.
'                  или массив - первая строка значения
'                               вторая строка - подписи
