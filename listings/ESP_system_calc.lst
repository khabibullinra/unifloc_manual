' расчет производительности системы УЭЦН
' считает перепад давления, электрические параметры и деградацию КПД
Public Function ESP_system_calc( _
                 ByVal q_liq_sm3day As Double, _
                 ByVal fw_perc As Double, _
                 ByVal qgas_free_sm3day As Double, _
                 ByVal p_calc_atma As Double, _
                 ByVal t_intake_C As Double, _
        Optional ByVal t_dis_C As Double = -1, _
        Optional ByVal str_PVT As String, _
        Optional ByVal str_ESP As String, _
        Optional ByVal str_motor As String, _
        Optional ByVal str_cable As String, _
        Optional ByVal str_gassep As String, _
        Optional ByVal calc_along_flow As Boolean = 1, _
        Optional ByVal out_curves_num_points As Integer = 20, _
        Optional ByVal num_value As Integer = 0)
' q_liq_sm3day       - дебит жидкости на поверхности
' fw_perc           - обводненность
' qgas_free_sm3day  - свободный газ в потоке
' p_calc_atma       - давление для которого делается расчет
'                     либо давление на приеме насоса
'                     либо давление на выкиде насоса
'                     определяется параметром calc_along_flow
' str_PVT            - набор данных PVT
' str_ESP            - набор данных ЭЦН
' calc_along_flow    - режим расчета снизу вверх или сверху вниз
'            calc_along_flow = True => p_atma давление на приеме
'           calc_along_flow = False => p_atma давление на выкиде
' out_curves_num_points - количество точек для вывода значений
'            по ступеня.
' num_value       - значение которое будет выводиться первым
' результат   - массив значений включающий
'            перепад давления
'            перепад температур
'            мощность потребляемая с вала, Вт
'            мощность гидравлическая по перекачке жидкости, Вт
'            КПД ЭЦН
'            список неполон
