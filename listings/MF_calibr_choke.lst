' расчет корректирующего фактора (множителя) модели штуцера под замеры
' медленный расчет - калибровка подбирается
Public Function MF_calibr_choke( _
            ByVal q_liq_sm3day As Double, _
            ByVal fw_perc As Double, _
            ByVal d_choke_mm As Double, _
            Optional ByVal p_in_atma As Double = -1, _
            Optional ByVal p_out_atma As Double = -1, _
            Optional ByVal d_pipe_mm As Double = 70, _
            Optional ByVal t_choke_C As Double = 20, _
            Optional ByVal str_PVT As String = PVT_DEFAULT, _
            Optional ByVal q_gas_sm3day As Double = 0, _
            Optional ByVal calibr_type As Integer = 0)
            
' q_liq_sm3day   - дебит жидкости в ст. условиях
' fw_perc       - обводненность
' d_choke_mm    - диаметр штуцера (эффективный), мм
' p_in_atma     - давление на входе (высокой стороне)
' p_out_atma    - давление на выходе (низкой стороне)
' d_pipe_mm     - диаметр трубы до и после штуцера, мм
' t_choke_C     - температура, С.
' str_PVT       - закодированная строка с параметрами PVT,
'                 если задана - перекрывает другие значения
' q_gas_sm3day  - свободный газ. дополнительный к PVT потоку.
' calibr_type - тип калибровки
'             0 - подбор параметра c_calibr
'             1 - подбор диаметра штуцера
'             2 - подбор газового фактор
'             3 - подбор обводненности
'             4 - подбор дебита жидкости
'             5 - подбор дебита газа свободного
' результат     - число - калибровочный коэффициент для модели.
'                 штуцера  - множитель на дебит через штуцер
