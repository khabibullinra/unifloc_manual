' Расчет устьевого давления скважины c УЭЦН,
' расчет распределения давления и температуры в скважине
' с использованием многофазных корреляций.
Public Function wellESP_plin_pwf_atma( _
             ByVal p_wf_atma As Double, _
             ByVal t_wf_C As Double, _
             ByVal q_liq_sm3day As Double, _
             ByVal fw_perc As Double, _
    Optional ByVal q_gas_sm3day As Double = 0, _
    Optional ByVal p_cas_atma As Double, _
    Optional ByVal str_PVT As String = PVT_DEFAULT, _
    Optional ByVal str_construct As String = "", _
    Optional ByVal str_ESP As String = "", _
    Optional ByVal str_gassep As String = "", _
    Optional ByVal str_motor As String = "", _
    Optional ByVal str_cable As String = "", _
    Optional ByVal str_amb As String = "", _
    Optional ByVal hcorr As H_CORRELATION = 0, _
    Optional ByVal tmethod As TEMP_CALC_METHOD = StartEndTemp, _
    Optional ByVal c_calibr = 1, _
    Optional ByVal out = 0)
' Обязательные параметры
'p_wf_atma - забойное давление с которого начинается расчет,
'            граничное значение для проведения расчета
't_wf_C    - температура флюида на забое
'qliq_sm3day - дебит жидкости в поверхностных условиях
'fw_perc     - обводненность
'q_gas_sm3day - свободный газ поступающие в скважину
'             на забое для ЭЦН, в затруб для газлифта.
'p_cas_atma - затрубное давление (расчета Ндин)
'str_PVT    - закодированная строка с параметрами PVT.
'             если задана - перекрывает другие значения
'str_ESP    - закодированная строка с установленным ЭЦН.
'str_gassep
'str_motor  - параметры ПЭД, если необходимы для расчета
'str_cable  - параметры кабеля, если есть ПЭД и
'             отличаются от стандартных
'str_amb    - параметры среды вокруг скважины.
'             влияют на расчет температуры для модели
'             учитывающей эмиссию тепла
'hcorr      - гидравлическая корреляция, H_CORRELATION
'                 BeggsBrill = 0
'                 Ansari = 1
'                 Unified = 2
'                 Gray = 3
'                 HagedornBrown = 4
'                 SakharovMokhov = 5
'tmethod    - температурная модель
'c_calibr   - поправка на гравитационную составляющую
'           перепада давления, если дать ссылку на две ячейки,
'           то вторая будет поправка на трение.
'out  - флаг вывод значений между концами трубы
'           1 основные, 2 все значения.
'           вывод может замедлять расчет (не сильно)
'num_value - значение которое будет выводиться первым
'результат - число - давление на устье скважины.
'           и распределение параметров по скважине.
