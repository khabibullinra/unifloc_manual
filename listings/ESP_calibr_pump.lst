' расчет подстроечных параметров системы УЭЦН
Public Function ESP_calibr_pump( _
                 ByVal qliq_sm3day As Double, _
                 ByVal fw_perc As Double, _
                 ByVal p_int_atma As Double, _
                 ByVal p_dis_atma As Double, _
        Optional ByVal num_stages As Integer = 1, _
        Optional ByVal freq_Hz As Double = 50, _
        Optional ByVal pump_id = 674, _
        Optional ByVal str_PVT As String = PVT_DEFAULT, _
        Optional ByVal t_intake_C As Double = 50, _
        Optional ByVal t_dis_C As Double = 50, _
        Optional ByVal calc_along_flow As Boolean = 1, _
        Optional ByVal ESP_gas_correct As Double = 1, _
        Optional ByVal c_calibr = 1, _
        Optional ByVal dnum_stages_integrate As Integer = 1, _
        Optional ByVal calibr_type As Integer = 0)
' qliq_sm3day       - дебит жидкости на поверхности
' fw_perc           - обводненность
' p_int_atma        - давление на приеме насоса
' p_dis_atma        - давление на выкиде насоса
' num_stages        - количество ступеней
' freq_Hz           - частота вращения вала ЭЦН, Гц
' pump_id           - идентификатор насоса
' str_PVT            - набор данных PVT
' t_intake_C        - температура на приеме насоа
' t_dis_C            - температура на выкиде насоса.
'                     если = 0 и calc_along_flow = 1 то рассчитывается
' calc_along_flow    - режим расчета снизу вверх или сверху вниз
'                 calc_along_flow = True => p_atma давление на приеме
'                 calc_along_flow = False => p_atma давление на выкиде
' ESP_gas_correct  - деградация по газу:
'     0 - 2 задает значение вручную;
'     10 стандартный ЭЦН (предел 25%);
'     20 ЭЦН с газостабилизирующим модулем (предел 50%);
'     30 ЭЦН с осевым модулем (предел 75%);
'     40 ЭЦН с модифицированным ступенями (предел 40%).
'     110+, тогда модель n-100 применяется ко всем ступеням отдельно
'     Предел по доле газа на входе в насос после сепарации
'     на основе статьи SPE 117414 (с корректировкой)
'     поправка дополнительная к деградации (суммируется).
' c_calibr  - коэффициент поправки на напор.
'     если массив то второе значение - поправыка на подачу (множитель)
'     третье на мощность (множитель)
' dnum_stages_integrate - шаг интегрирования ЭЦН
'           если >1 будет быстрее но менее точно
' calibr_type - тип калибровки
' результат   - массив значений включающий
