'  расчет распределения давления и температуры в трубе
'  с использованием многофазных корреляций
Public Function MF_p_pipe_atma( _
        ByVal qliq_sm3day As Double, _
        ByVal fw_perc As Double, _
        ByVal length_m As Double, _
        ByVal p_calc_from_atma As Double, _
        ByVal calc_along_flow As Boolean, _
        Optional ByVal str_PVT As String = PVT_DEFAULT, _
        Optional ByVal theta_deg As Double = 90, _
        Optional ByVal d_mm As Double = 60, _
        Optional ByVal hydr_corr As H_CORRELATION = 0, _
        Optional ByVal t_calc_from_C As Double = 50, _
        Optional ByVal t_calc_to_C As Double = -1, _
        Optional ByVal c_calibr_grav = 1, _
        Optional ByVal c_calibr_fric = 1, _
        Optional ByVal roughness_m As Double = 0.0001, _
        Optional ByVal q_gas_sm3day As Double = 0, _
        Optional ByVal out_curves As Integer = 1, _
        Optional ByVal out_curves_num_points As Integer = 20)
' qliq_sm3day     - дебит жидкости в поверхностных условиях
'              если qliq_sm3day =0 и q_gas_sm3day > 0
'              тогда считается барботаж газа через жидкость
' fw_perc         - обводненность
' length_m        - Длина трубы, измеренная, м
'p_calc_from_atma - давление с которого начинается расчет, атм
'                   граничное значение для проведения расчета
' calc_along_flow - флаг направления расчета относительно потока
'                   если = 1 то расчет по потоку
'                   если = 0 то расчет против потока
' str_PVT         - закодированная строка с параметрами PVT.
'                   если задана - перекрывает другие значения
'        если задан флаг gas_only = 1 то жидкость не учитывается
' theta_deg       - угол направления потока к горизонтали
'                   ( 90 - вертикальная труба поток вверх
'                    -90 - вертикальная труба поток вниз)
'                   может принимать отрицательные значения
' d_mm            - внутрнний диаметр трубы
' hydr_corr       - гидравлическая корреляция, H_CORRELATION
'                    BeggsBrill = 0
'                    Ansari = 1
'                    Unified = 2
'                    Gray = 3
'                    HagedornBrown = 4
'                    SakharovMokhov = 5
' t_calc_from_C   - температура в точке где задано давление, С
' t_calc_to_C     - температура на другом конце трубы
'                 по умолчанию температура вдоль трубы постоянна
'                   если задано то меняется линейно по трубе
' c_calibr_grav   - поправка на гравитационную составляющую
'                   перепада давления
' c_calibr_fric   - поправка на трение в перепаде давления
' roughness_m     - шероховатость трубы
' q_gas_sm3day    - свободный газ. дополнительный к PVT потоку.
' out_curves      - флаг вывод значений между концами трубы
'                   0 минимум, 1 основныеб 2 все значения.
'                   вывод может замедлять расчет (не сильно)
' out_curves_num_points - количество точек для вывода значений
'                   между концами трубы.
' результат       - число - давление на другом конце трубы atma.
'                  или массив - первая строка значения
'                               вторая строка - подписи
