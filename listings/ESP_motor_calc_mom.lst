' функция расчета параметров двигателя по заданному моменту на валу
Public Function ESP_motor_calc_mom(ByVal mom_Nm As Double, _
                          Optional ByVal freq_Hz As Double = 50, _
                          Optional ByVal U_V As Double = -1, _
                          Optional ByVal U_nom_V As Double = 500, _
                          Optional ByVal P_nom_kW As Double = 10, _
                          Optional ByVal f_nom_Hz As Double = 50, _
                          Optional ByVal motorID As Integer = 0, _
                          Optional ByVal eff_nom_fr As Double = 0.85, _
                          Optional ByVal cosphi_nom_fr As Double = 0.8, _
                          Optional ByVal slip_nom_fr As Double = 0.05, _
                          Optional ByVal d_od_mm As Double = 117, _
                          Optional ByVal Lambda As Double = 2, _
                          Optional ByVal alpha0 As Double = 0.4, _
                          Optional ByVal xi0 As Double = 1.05, _
                          Optional ByVal Ixcf As Double = 0.4) _
                  As Variant
' mom_Nm      - момент развиваемый двигателем на валу, Нм
' freq_Hz     - частота вращения внешнего поля
' U_V         - напряжение рабочее, линейное, В
' U_nom_V     - номинальное напряжение питания двигателя, линейное, В
' P_nom_kW    - номинальная мощность двигателя кВт
' f_nom_Hz    - номинальная частота вращения поля, Гц
' motorID     - тип 0 - постоянные значения,
'                   1 - задается по каталожным кривым, ассинхронный
'                   2 - задается по схеме замещения, ассинхронный
' eff_nom_fr  - КПД при номинальном режиме работы
' cosphi_nom_fr - коэффициент мощности при номинальном режиме работы
' slip_nom_fr - скольжение при номинальном режиме работы
' d_od_mm     - внешний диаметр - габарит ПЭД
' lambda      - для motorID = 2 перегрузочный коэффициент
'               отношение макс момента к номинальному
' alpha0  - параметр. влияет на положение макс КПД.для motorID = 2
' xi0     - параметр. определяет потери момента при холостом ходе.
'           для motorID = 2
' Ixcf    - поправка на поправку тока холостого хода
'           при изменении напряжения и частоты от минимальной.
'           для motorID = 2' результат   - момент на валу двигателя
